# **seL4-manual解读**

## **介绍**

seL4微内核是一种操作系统内核，旨在为各种应用程序域中的系统提供安全、安全、可靠的基础，它仅向应用程序提供少量服务（比如创建和管理虚拟地址空间、线程、进程间通信-IPC）。seL4大约8700行C代码，其完整性和保密性得到了证明(https://github.com/seL4/l4v)。微内核也有助于对最坏情况执行时间进行统筹分析。

manual从用户角度描述seL4内核API，首先概述seL4的设计模式，然后介绍seL4向用户空间开放的高级API。

文档描述并不保证严格符合seL4的真实行为，如有确定内核在特定环境下的精确行为的需求，应参考seL4抽象规范（seL4 abstract specification）(https://www.sel4.systems/Info/Docs/seL4-spec.pdf)，该规范是seL4内核的正式描述。

## **内核服务和对象**

微内核提供了有限的服务原语。更复杂的服务可以作为应用程序用这些原语实现。这样可以不增加特权模式代码以及复杂性，还能扩展功能，从而支持各种应用程序域的大量服务。
**注意，只有在内核配置为MCS（mixed-criticality system）支持时，一些服务才可用。**

seL4提供以下基本服务：

1. **Threads 线程**是支持软件运行的CPU执行的抽象;
2. **Scheduling contexts 调度上下文(仅MCS配置下)**是CPU执行时间的抽象。
3. **Address spaces 地址空间**是虚拟内存空间，每个地址空间包含一个应用程序。应用程序只能访问地址空间中的内存;
4. **Inter-process communication 通过端点的进程间通信(IPC)**允许线程使用消息传递进行通信;
5. **Reply objects 应答对象(仅MCS配置下)**用于存储一次性应答功能，在消息传递期间由接收方提供。
6. **Notifications 通知**提供了一种类似于二进制信号量的非阻塞信号机制。
7. **Device primitives 设备原语**允许将设备驱动程序实现为非特权应用程序。内核通过IPC消息导出硬件设备中断;
8. **Capability spaces 权限空间**存储对内核服务的权限(即访问权限)及其记录信息。

本章概述了这些服务，描述了用户空间应用程序如何访问内核对象，以及如何创建新的对象。
### **基于权限的访问控制**

seL4微内核提供了一个基于功能的访问控制模型。访问控制控制所有内核服务;为了执行操作，应用程序必须调用其拥有的对所请求的服务具有足够访问权限的功能。有了这一点，系统可以配置为彼此隔离的软件组件，也可以通过有选择地授予特定的通信能力，在组件之间实现授权的、受控的通信。这使得软件组件隔离具有高度的安全性，因为只有那些由功能拥有明确授权的操作才被允许。

一个权限空间是一个不可伪造的令牌，它引用特定的内核对象(如线程控制块TCB)，并携带控制可能调用哪些方法的访问权限。从概念上讲，权限存在于应用程序的权限空间中;这个空间中的地址指的是一个可能包含也可能不包含权限的槽位。应用程序可以引用一种权限（例如，请求内核服务，也就是使用持有该权限的槽的地址）。这意味着，seL4权限模型是一个隔离(或分区)权限系统的实例，其中的权限由内核管理。

权限空间被实现为内核管理权限节点(Cnode)的有向图。CNode是槽（Slot）组成的表，其中每个槽可能包含更多的CNode功能。权限空间中的一个权限地址是连接Cnode中的槽位索引，形成到目标槽位的路径;[第三章](#她她她)详细讨论了CNode对象。

## **她她她**